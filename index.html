<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><style>
body {
  background-color: #FEFEFE;
  padding: 4px;
  line-height: 3rem;
  font-family: "Droid Sans Mono", "monospace", monospace;
}

#phidden {
  white-space: pre-line;
}</style></head><body><div><input type="password" id="passwordInput"><button id="enter">Enter</button></div><div><input type="checkbox" id="upper" name="upper" checked="true"><label for="upper">upper</label><input type="checkbox" id="lower" name="lower" checked="true"><label for="lower">lower</label><input type="checkbox" id="symbol" name="symbol" checked="true"><label for="symbol">symbol</label><input type="checkbox" id="number" name="number" checked="true"><label for="number">number</label></div><select id="len" tabindex="-1"><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16" selected="true">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select><div><div id="phidden"></div><input type="checkbox" id="show" name="show"><label for="show">show</label></div><div id="tips"></div><script defer="true">async function A(d,E,I,m){let c=new TextEncoder,T=c.encode(d),P=c.encode(E),q=await crypto.subtle.importKey("raw",T,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),z=await crypto.subtle.deriveBits({name:"PBKDF2",salt:P,iterations:I,hash:"SHA-256"},q,m);return new Uint8Array(z)}function F(d){let E="[^";if(d.hasUpper)E+="A-Z";if(d.hasLower)E+="a-z";if(d.hasNumber)E+="0-9";return E+="]",E}function G(d){let E=Number(d.hasUpper)+Number(d.hasLower)+Number(d.hasNumber)+Number(d.hasSymbol);return d.len-E}function J(d,E){let m=btoa(String.fromCharCode(...d)).replace(new RegExp(F(E),"g"),"");if(m.length===0)throw alert("empty"),"empty";else{let c=G(E),T=Math.ceil(c/m.length);return m.repeat(T).slice(0,c)}}function l(d,E,I){let m=E%(d.length+1);return d.slice(0,m)+I+d.slice(m)}function L(d,E,I){if(I.hasUpper){let m=String.fromCharCode(65+E[28]%26);d=l(d,E[28],m)}if(I.hasLower){let m=String.fromCharCode(97+E[29]%26);d=l(d,E[29],m)}if(I.hasNumber){let m=String.fromCharCode(48+E[30]%10);d=l(d,E[30],m)}if(I.hasSymbol){let m=E[31]%2?"_":"=";d=d+m}return d}async function M(d,E){let I=await A(d,"PasswordHash",1e6,256),m=J(I,E);return L(m,I,E)}var H=document.getElementById("passwordInput"),Q=document.getElementById("enter"),k=document.getElementById("phidden"),D=document.getElementById("show"),j=document.getElementById("tips"),V=document.getElementById("upper"),W=document.getElementById("lower"),X=document.getElementById("symbol"),Y=document.getElementById("number"),Z=document.getElementById("len");function _(){let d=V.checked,E=W.checked,I=X.checked,m=Y.checked,c=parseInt(Z.value,10);return{hasUpper:d,hasLower:E,hasSymbol:I,hasNumber:m,len:c}}function B(d){return Array.from(d).map((E)=>"*").join("")}function C(d,E){if(D.checked)k.textContent=d+`
`+E;else{let I=E[0]+B(E.slice(1));k.textContent=B(d)+`
`+I}}async function y(d){let E=await M(d,_());await window.navigator.clipboard.writeText(E),C(d,E),D.onchange=(I)=>{C(d,E)},j.textContent="write to clipboard success"}Q.onclick=()=>{y(H.value)};H.onkeyup=(d)=>{if(d.key==="Enter")y(H.value);else j.textContent=""};H.focus();
</script></body></html>