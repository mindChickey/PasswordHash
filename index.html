<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><style>
body {
  background-color: #FEFEFE;
  padding: 4px;
  line-height: 3rem;
  font-family: "Droid Sans Mono", "monospace", monospace;
}

#phidden {
  white-space: pre-line;
}</style></head><body><div><input type="password" id="passwordInput"><button id="enter">Enter</button></div><div><div><input type="radio" name="mode" id="checkbox_mode" value="checkbox_mode"><label for="checkbox_mode">checkbox</label><div><input type="checkbox" id="upper" name="upper" checked="true"><label for="upper">upper</label><input type="checkbox" id="lower" name="lower" checked="true"><label for="lower">lower</label><input type="checkbox" id="symbol" name="symbol" checked="true"><label for="symbol">symbol</label><input type="checkbox" id="number" name="number" checked="true"><label for="number">number</label><select id="len" tabindex="-1"><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16" selected="true">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></div></div><div><input type="radio" name="mode" id="hand_mode" value="hand_mode"><label for="hand_mode">hand write</label></div><div><input type="radio" name="mode" id="digit_mode" value="digit_mode"><label for="digit_mode">6 digit</label></div></div><div><div id="phidden"></div><input type="checkbox" id="show" name="show"><label for="show">show</label></div><div id="tips"></div><script defer="true">async function B(d,m,E,e){let l=new TextEncoder,c=l.encode(d),H=l.encode(m),T=await crypto.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),W=await crypto.subtle.deriveBits({name:"PBKDF2",salt:H,iterations:E,hash:"SHA-256"},T,e);return new Uint8Array(W)}function q(d){let m="[^";if(d.hasUpper)m+="A-Z";if(d.hasLower)m+="a-z";if(d.hasNumber)m+="0-9";return m+="]",m}function z(d){let m=Number(d.hasUpper)+Number(d.hasLower)+Number(d.hasNumber)+Number(d.hasSymbol);return d.len-m}function A(d,m){let e=btoa(String.fromCharCode(...d)).replace(new RegExp(q(m),"g"),"");if(e.length===0)throw alert("empty"),"empty";else{let l=z(m),c=Math.ceil(l/e.length);return e.repeat(c).slice(0,l)}}function M(d,m,E){let e=m%(d.length+1);return d.slice(0,e)+E+d.slice(e)}function C(d,m,E){if(E.hasUpper){let e=String.fromCharCode(65+m[28]%26);d=M(d,m[28],e)}if(E.hasLower){let e=String.fromCharCode(97+m[29]%26);d=M(d,m[29],e)}if(E.hasNumber){let e=String.fromCharCode(48+m[30]%10);d=M(d,m[30],e)}if(E.hasSymbol){let e=m[31]%2?"_":"=";d=d+e}return d}async function n(d,m){let E=await B(d,"PasswordHash",1e6,256),e=A(E,m);return C(e,E,m)}function k(d,m){return Array.from(d).map((l)=>m[l%m.length]).join("")}async function _(d){let l=await B(d,"PasswordHash",1e6,256),c=k(l.slice(0,4),"ABCDEFGHJKLMNPQRSTUVWXYZ"),H=k(l.slice(4,8),"abcdefghijkmnpqrstuvwxyz"),T=k(l.slice(8,10),"23456789");return c+H+T}var I=document.getElementById("passwordInput"),F=document.getElementById("enter"),y=document.getElementById("phidden"),D=document.getElementById("show"),j=document.getElementById("tips"),G=document.getElementById("upper"),J=document.getElementById("lower"),Q=document.getElementById("symbol"),V=document.getElementById("number"),X=document.getElementById("len"),Y=document.getElementById("checkbox_mode"),Z=document.getElementById("hand_mode"),w=document.getElementById("digit_mode");function $(){let d=G.checked,m=J.checked,E=Q.checked,e=V.checked,l=parseInt(X.value,10);return{hasUpper:d,hasLower:m,hasSymbol:E,hasNumber:e,len:l}}function u(d){return Array.from(d).map((m)=>"*").join("")}function L(d,m){if(D.checked)y.textContent=d+`
`+m;else{let E=m[0]+u(m.slice(1));y.textContent=u(d)+`
`+E}}async function R(d){if(Y.checked)return await n(d,$());else if(Z.checked)return await _(d);else return await n(d,{hasUpper:!1,hasLower:!1,hasSymbol:!1,hasNumber:!0,len:6})}async function P(d){let m=await R(d);await window.navigator.clipboard.writeText(m),L(d,m),D.onchange=(E)=>{L(d,m)},j.textContent="write to clipboard success"}F.onclick=()=>{P(I.value)};I.onkeyup=(d)=>{if(d.key==="Enter")P(I.value);else j.textContent=""};I.focus();
</script></body></html>