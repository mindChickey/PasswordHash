var E="ABCDEFGHIJKLMNOPQRSTUVWXYZ",y="abcdefghijklmnopqrstuvwxyz",f="0123456789";async function v(d,e,n,u){let c=new TextEncoder,l=c.encode(d),I=c.encode(e),h=await crypto.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),M={name:"PBKDF2",salt:I,iterations:n,hash:"SHA-256"},T=await crypto.subtle.deriveBits(M,h,u);return new Uint8Array(T)}function L(d,e){let n=[],u=0;for(let c of e){let l=d.slice(u,u+c);n.push(l),u+=c}return n}function t(d,e){return Array.from(d).map((c)=>e[c%e.length]).join("")}function J(d,e){let n=e.hasUpper?t(d[0],E):"",u=e.hasLower?t(d[1],y):"",c=e.hasNumber?t(d[2],f):"";return n+u+c}function Q(d,e){let n=e.hasUpper?E:"",u=e.hasLower?y:"",c=e.hasNumber?f:"",l=n+u+c;return t(d,l)}async function w(d,e){let n=await v(d,"PasswordHash",1e6,256),u=L(n,[1,1,1,e.len]),c=J(u,e),l=u[3].slice(0,e.len-c.length),I=Q(l,e);return c+I}async function b(d,e){let n=await v(d,"PasswordHash",1e6,256),u=Math.ceil(e/3),c=e-2*u,l=L(n,[u,u,c]),I=E.replace(/[OI]/g,""),h=y.replace(/[ol]/g,""),M=f.replace(/[01]/g,""),T=t(l[0],I),F=t(l[1],h),G=t(l[2],M);return T+F+G}var B=document.getElementById("passwordInput"),V=document.getElementById("enterButton"),j=document.getElementById("phiddenDiv"),k=document.getElementById("showCheckBox"),q=document.getElementById("tipsDiv"),g=document.getElementById("autoCopyCheckBox"),X=document.getElementById("upperCheckBox"),Y=document.getElementById("lowerCheckBox"),Z=document.getElementById("numberCheckBox"),m=document.getElementById("lenInput"),D=document.getElementById("customModeRadio"),H=document.getElementById("handModeRadio"),o=document.getElementById("digitModeRadio");function $(){let d=X.checked,e=Y.checked,n=Z.checked,u=parseInt(m.value,10);return{hasUpper:d,hasLower:e,hasNumber:n,len:u}}function a(d){return Array.from(d).map((e)=>"*").join("")}function i(d,e){if(k.checked)j.textContent=d+`
`+e;else{let n=e[0]+a(e.slice(1));j.textContent=a(d)+`
`+n}}async function W(d){if(D.checked)return await w(d,$());else if(H.checked){let e=parseInt(m.value,10);return await b(d,e)}else{let n={hasUpper:!1,hasLower:!1,hasNumber:!0,len:parseInt(m.value,10)};return await w(d,n)}}async function z(d){let e=await W(d);if(i(d,e),k.onchange=(n)=>{i(d,e)},g.checked)await window.navigator.clipboard.writeText(e),q.textContent="write to clipboard success"}V.onclick=()=>{z(B.value)};B.onkeyup=(d)=>{if(d.key==="Enter")z(B.value);else q.textContent=""};D.onchange=()=>{if(D.checked)g.checked=!0,k.checked=!1,m.value="15"};H.onchange=()=>{if(H.checked)g.checked=!1,k.checked=!0,m.value="10"};o.onchange=()=>{if(o.checked)g.checked=!1,k.checked=!0,m.value="6"};B.focus();
