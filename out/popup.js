var E="ABCDEFGHIJKLMNOPQRSTUVWXYZ",k="abcdefghijklmnopqrstuvwxyz",M="0123456789";async function y(n,e,m,d){let l=new TextEncoder,t=l.encode(n),I=l.encode(e),c=await crypto.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),T={name:"PBKDF2",salt:I,iterations:m,hash:"SHA-256"},z=await crypto.subtle.deriveBits(T,c,d);return new Uint8Array(z)}function B(n,e){let m=[],d=0;for(let l of e){let t=n.slice(d,d+l);m.push(t),d+=l}return m}function u(n,e){return Array.from(n).map((l)=>e[l%e.length]).join("")}function F(n,e){let m=e.hasUpper?u(n[0],E):"",d=e.hasLower?u(n[1],k):"",l=e.hasNumber?u(n[2],M):"";return m+d+l}function G(n,e){let m=e.hasUpper?E:"",d=e.hasLower?k:"",l=e.hasNumber?M:"",t=m+d+l;return u(n,t)}async function w(n,e){let m=await y(n,"PasswordHash",1e6,256),d=B(m,[1,1,1,e.len]),l=F(d,e),t=d[3].slice(0,e.len-l.length),I=G(t,e);return l+I}async function L(n){let e=await y(n,"PasswordHash",1e6,256),m=B(e,[4,4,2]),d=E.replace(/[OI]/g,""),l=k.replace(/[ol]/g,""),t=M.replace(/[01]/g,""),I=u(m[0],d),c=u(m[1],l),T=u(m[2],t);return I+c+T}var g=document.getElementById("passwordInput"),J=document.getElementById("enter"),H=document.getElementById("phidden"),f=document.getElementById("show"),j=document.getElementById("tips"),Q=document.getElementById("upper"),V=document.getElementById("lower"),X=document.getElementById("number"),Y=document.getElementById("len"),Z=document.getElementById("checkbox_mode"),$=document.getElementById("hand_mode"),v=document.getElementById("digit_mode");function W(){let n=Q.checked,e=V.checked,m=X.checked,d=parseInt(Y.value,10);return{hasUpper:n,hasLower:e,hasNumber:m,len:d}}function b(n){return Array.from(n).map((e)=>"*").join("")}function D(n,e){if(f.checked)H.textContent=n+`
`+e;else{let m=e[0]+b(e.slice(1));H.textContent=b(n)+`
`+m}}async function N(n){if(Z.checked)return await w(n,W());else if($.checked)return await L(n);else return await w(n,{hasUpper:!1,hasLower:!1,hasNumber:!0,len:6})}async function q(n){let e=await N(n);await window.navigator.clipboard.writeText(e),D(n,e),f.onchange=(m)=>{D(n,e)},j.textContent="write to clipboard success"}J.onclick=()=>{q(g.value)};g.onkeyup=(n)=>{if(n.key==="Enter")q(g.value);else j.textContent=""};g.focus();
