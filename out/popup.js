var M="ABCDEFGHIJKLMNOPQRSTUVWXYZ",T="abcdefghijklmnopqrstuvwxyz",E="0123456789";async function o(e,n,t,d){let m=new TextEncoder,l=m.encode(e),c=m.encode(n),k=await crypto.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),B={name:"PBKDF2",salt:c,iterations:t,hash:"SHA-256"},b=await crypto.subtle.deriveBits(B,k,d);return new Uint8Array(b)}function L(e,n){let t=[],d=0;for(let m of n){let l=e.slice(d,d+m);t.push(l),d+=m}return t}function u(e,n){return Array.from(e).map((m)=>n[m%n.length]).join("")}function j(e,n){let t=n.hasUpper?u(e[0],M):"",d=n.hasLower?u(e[1],T):"",m=n.hasNumber?u(e[2],E):"";return t+d+m}function q(e,n){let t=n.hasUpper?M:"",d=n.hasLower?T:"",m=n.hasNumber?E:"",l=t+d+m;return u(e,l)}async function y(e,n){let t=await o(e,"PasswordHash",1e6,256),d=L(t,[1,1,1,n.len]),m=j(d,n),l=d[3].slice(0,n.len-m.length),c=q(l,n);return m+c}async function f(e){let n=await o(e,"PasswordHash",1e6,256),t=L(n,[4,4,2]),d=M.replace(/[OI]/g,""),m=T.replace(/[ol]/g,""),l=E.replace(/[01]/g,""),c=u(t[0],d),k=u(t[1],m),B=u(t[2],l);return c+k+B}var I=document.getElementById("passwordInput"),z=document.getElementById("enterButton"),i=document.getElementById("phiddenDiv"),g=document.getElementById("showCheckBox"),H=document.getElementById("tipsDiv"),h=document.getElementById("autoCopyCheckBox"),F=document.getElementById("upperCheckBox"),G=document.getElementById("lowerCheckBox"),J=document.getElementById("numberCheckBox"),Q=document.getElementById("lenInput"),V=document.getElementById("modeContainer"),X=document.getElementById("customModeRadio"),Y=document.getElementById("handModeRadio"),x=document.getElementById("digitModeRadio");function Z(){let e=F.checked,n=G.checked,t=J.checked,d=parseInt(Q.value,10);return{hasUpper:e,hasLower:n,hasNumber:t,len:d}}function w(e){return Array.from(e).map((n)=>"*").join("")}function D(e,n){if(g.checked)i.textContent=e+`
`+n;else{let t=n[0]+w(n.slice(1));i.textContent=w(e)+`
`+t}}async function $(e){if(X.checked)return await y(e,Z());else if(Y.checked)return await f(e);else return await y(e,{hasUpper:!1,hasLower:!1,hasNumber:!0,len:6})}async function a(e){let n=await $(e);if(D(e,n),g.onchange=(t)=>{D(e,n)},h.checked)await window.navigator.clipboard.writeText(n),H.textContent="write to clipboard success"}z.onclick=()=>{a(I.value)};I.onkeyup=(e)=>{if(e.key==="Enter")a(I.value);else H.textContent=""};function v(e){if(e==="custom_mode")h.checked=!0,g.checked=!1;else h.checked=!1,g.checked=!0}V.onchange=(e)=>{if(!e.target)return;else if(e.target.name==="mode")v(e.target.value)};I.focus();
