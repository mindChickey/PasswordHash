async function B(d,m,I,E){let e=new TextEncoder,l=e.encode(d),H=e.encode(m),T=await crypto.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),W=await crypto.subtle.deriveBits({name:"PBKDF2",salt:H,iterations:I,hash:"SHA-256"},T,E);return new Uint8Array(W)}function q(d){let m="[^";if(d.hasUpper)m+="A-Z";if(d.hasLower)m+="a-z";if(d.hasNumber)m+="0-9";return m+="]",m}function z(d){let m=Number(d.hasUpper)+Number(d.hasLower)+Number(d.hasNumber)+Number(d.hasSymbol);return d.len-m}function A(d,m){let E=btoa(String.fromCharCode(...d)).replace(new RegExp(q(m),"g"),"");if(E.length===0)throw alert("empty"),"empty";else{let e=z(m),l=Math.ceil(e/E.length);return E.repeat(l).slice(0,e)}}function M(d,m,I){let E=m%(d.length+1);return d.slice(0,E)+I+d.slice(E)}function C(d,m,I){if(I.hasUpper){let E=String.fromCharCode(65+m[28]%26);d=M(d,m[28],E)}if(I.hasLower){let E=String.fromCharCode(97+m[29]%26);d=M(d,m[29],E)}if(I.hasNumber){let E=String.fromCharCode(48+m[30]%10);d=M(d,m[30],E)}if(I.hasSymbol){let E=m[31]%2?"_":"=";d=d+E}return d}async function k(d,m){let I=await B(d,"PasswordHash",1e6,256),E=A(I,m);return C(E,I,m)}function n(d,m){return Array.from(d).map((e)=>m[e%m.length]).join("")}async function u(d){let e=await B(d,"PasswordHash",1e6,256),l=n(e.slice(0,4),"ABCDEFGHJKLMNPQRSTUVWXYZ"),H=n(e.slice(4,8),"abcdefghijkmnpqrstuvwxyz"),T=n(e.slice(8,10),"23456789");return l+H+T}var c=document.getElementById("passwordInput"),F=document.getElementById("enter"),_=document.getElementById("phidden"),D=document.getElementById("show"),j=document.getElementById("tips"),G=document.getElementById("upper"),J=document.getElementById("lower"),Q=document.getElementById("symbol"),V=document.getElementById("number"),X=document.getElementById("len"),Y=document.getElementById("checkbox_mode"),Z=document.getElementById("hand_mode"),w=document.getElementById("digit_mode");function $(){let d=G.checked,m=J.checked,I=Q.checked,E=V.checked,e=parseInt(X.value,10);return{hasUpper:d,hasLower:m,hasSymbol:I,hasNumber:E,len:e}}function y(d){return Array.from(d).map((m)=>"*").join("")}function L(d,m){if(D.checked)_.textContent=d+`
`+m;else{let I=m[0]+y(m.slice(1));_.textContent=y(d)+`
`+I}}async function R(d){if(Y.checked)return await k(d,$());else if(Z.checked)return await u(d);else return await k(d,{hasUpper:!1,hasLower:!1,hasSymbol:!1,hasNumber:!0,len:6})}async function P(d){let m=await R(d);await window.navigator.clipboard.writeText(m),L(d,m),D.onchange=(I)=>{L(d,m)},j.textContent="write to clipboard success"}F.onclick=()=>{P(c.value)};c.onkeyup=(d)=>{if(d.key==="Enter")P(c.value);else j.textContent=""};c.focus();
