var E="ABCDEFGHIJKLMNOPQRSTUVWXYZ",y="abcdefghijklmnopqrstuvwxyz",B="0123456789";async function M(n,e,m,t){let d=new TextEncoder,l=d.encode(n),I=d.encode(e),g=await crypto.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),T={name:"PBKDF2",salt:I,iterations:m,hash:"SHA-256"},z=await crypto.subtle.deriveBits(T,g,t);return new Uint8Array(z)}function w(n,e){let m=[],t=0;for(let d of e){let l=n.slice(t,t+d);m.push(l),t+=d}return m}function u(n,e){return Array.from(n).map((d)=>e[d%e.length]).join("")}function F(n,e){let m=e.hasUpper?u(n[0],E):"",t=e.hasLower?u(n[1],y):"",d=e.hasNumber?u(n[2],B):"";return m+t+d}function G(n,e){let m=e.hasUpper?E:"",t=e.hasLower?y:"",d=e.hasNumber?B:"",l=m+t+d;return u(n,l)}async function k(n,e){let m=await M(n,"PasswordHash",1e6,256),t=w(m,[1,1,1,e.len]),d=F(t,e),l=t[3].slice(0,e.len-d.length),I=G(l,e);return d+I}async function L(n){let e=await M(n,"PasswordHash",1e6,256),m=w(e,[4,4,2]),t=E.replace(/[OI]/g,""),d=y.replace(/[ol]/g,""),l=B.replace(/[01]/g,""),I=u(m[0],t),g=u(m[1],d),T=u(m[2],l);return I+g+T}var c=document.getElementById("passwordInput"),J=document.getElementById("enter"),H=document.getElementById("phidden"),b=document.getElementById("show"),j=document.getElementById("tips"),Q=document.getElementById("auto_copy"),V=document.getElementById("upper"),X=document.getElementById("lower"),Y=document.getElementById("number"),Z=document.getElementById("len"),$=document.getElementById("custom_mode"),W=document.getElementById("hand_mode"),O=document.getElementById("digit_mode");function N(){let n=V.checked,e=X.checked,m=Y.checked,t=parseInt(Z.value,10);return{hasUpper:n,hasLower:e,hasNumber:m,len:t}}function f(n){return Array.from(n).map((e)=>"*").join("")}function D(n,e){if(b.checked)H.textContent=n+`
`+e;else{let m=e[0]+f(e.slice(1));H.textContent=f(n)+`
`+m}}async function K(n){if($.checked)return await k(n,N());else if(W.checked)return await L(n);else return await k(n,{hasUpper:!1,hasLower:!1,hasNumber:!0,len:6})}async function q(n){let e=await K(n);if(D(n,e),b.onchange=(m)=>{D(n,e)},Q.checked)await window.navigator.clipboard.writeText(e),j.textContent="write to clipboard success"}J.onclick=()=>{q(c.value)};c.onkeyup=(n)=>{if(n.key==="Enter")q(c.value);else j.textContent=""};c.focus();
